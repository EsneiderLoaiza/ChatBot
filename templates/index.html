<!DOCTYPE html>
<html>
<!--From https://codepen.io/frytyler/pen/EGdtg-->

<head>
  <meta charset="UTF-8">
  <title>Chatbot</title>
  <link href='https://fonts.googleapis.com/css?family=Pacifico' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Arimo' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Hind:300' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link
  href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.0.0/mdb.min.css"
  rel="stylesheet"
  />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

</head>

<body>
    
  <div  style="width:100%; height:100%; overflow: scroll;">
    <div class="menu">
      <div class="back"><i class="fa fa-chevron-left"></i> <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava1-bg.webp"
        alt="avatar 1" />
      </div>
      <div class="name">Bot asistente virtual</div>
      <div class="last">08:17</div>
    </div>
    <ol class="chat">
      <li class="other">
        <div class="avatar"><img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava1-bg.webp"
          alt="avatar 1" style="width: 45px; height: 100%;"/></div>
        <div class="msg">
          <p>Hola!</p>
          <p>Bienvenido al asistente virtual
            <emoji class="pizza" />
          </p>
          <time>08:17</time>
        </div>
      </li>
  
      <ul id="myUL">
      </ul>
  
    </ol>
    <h1>{{ prediction_text }}</h1>
  
    <div class="form-outline">
      <input type="text" name="experience" id="myInput" placeholder="Escribe una pregunta" required="required" />
    </div>
    <button class="btn btn-success btn-block btn-large" onclick="request()">Enviar</button>
  
    </div>
  </div>

  <script>

    function request() {
      var name = document.getElementById("myInput").value;
      const dataString = {
        name: name,
      }
      $.ajax({
        type: "POST",
        url: "http://127.0.0.1:5000/predict",
        data: dataString,
        success: function(result) {
          getChat(result);
        }
      });
    }

    function getChat(result) {
      var li = document.createElement("p");
      var lir = document.createElement("p");
      var inputValue = document.getElementById("myInput").value;
      var responseValue = result;
      
      li.innerHTML +='<li class="self">'+
      '<div class="avatar"><img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava1-bg.webp"'+
        'alt="avatar 1" style="width: 45px; height: 100%;"/></div>'+
      '<div class="msg">'+
        '<p>'+inputValue+'</p>'+
      '</div>'+
      '</li>';

      lir.innerHTML +='<li class="other">'+
        '<div class="avatar"><img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava1-bg.webp" alt="avatar 1" style="width: 45px; height: 100%;"></div>'+
      '<div class="msg">'+
        '<p>'+responseValue+'</p>'+
      '</div>'+
      '</li>';
      
      if (inputValue === '') {
        alert("Debes escribir algo");
      } else {
        document.getElementById("myUL").appendChild(li);
        document.getElementById("myUL").appendChild(lir);
      }
      document.getElementById("myInput").value = "";
    
      for (i = 0; i < close.length; i++) {
        close[i].onclick = function() {
          var div = this.parentElement;
          div.style.display = "none";
        }
      }
    }

  </script>

</body>
</html>